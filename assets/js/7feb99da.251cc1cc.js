"use strict";(self.webpackChunkzero_to_flakes=self.webpackChunkzero_to_flakes||[]).push([[241],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=p(n),d=o,h=m["".concat(s,".").concat(d)]||m[d]||u[d]||a;return n?r.createElement(h,l(l({ref:t},c),{},{components:n})):r.createElement(h,l({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[m]="string"==typeof e?e:o,l[1]=i;for(var p=2;p<a;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8205:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const a={slug:"/mission-control"},l="Devshell scripts (mission-control)",i={unversionedId:"modules/mission-control",id:"modules/mission-control",title:"Devshell scripts (mission-control)",description:"The mission-control flake-parts module enables creating a set of scripts or commands to run in the Nix dev shell. This makes it possible for the project's user to locate all of the commands\xa0they need (to get started) in one place, often replacing the likes of Makefile or bin/ scripts.",source:"@site/docs/modules/mission-control.md",sourceDirName:"modules",slug:"/mission-control",permalink:"/mission-control",draft:!1,editUrl:"https://github.com/juspay/zero-to-flakes/tree/main/docs/modules/mission-control.md",tags:[],version:"current",frontMatter:{slug:"/mission-control"},sidebar:"tutorialSidebar",previous:{title:"Reference",permalink:"/haskell-flake/ref"},next:{title:"Auto formatting (treefmt-nix)",permalink:"/treefmt-nix"}},s={},p=[{value:"Usage",id:"usage",level:2},{value:"Add a script (Haskell)",id:"add-a-script-haskell",level:2},{value:"Docs (Hoogle)",id:"docs-hoogle",level:3},{value:"Cabal repl",id:"cabal-repl",level:3},{value:"treefmt",id:"treefmt",level:3},{value:"Tips",id:"tips",level:2},{value:"wrapperName",id:"wrappername",level:3},{value:"Upcoming",id:"upcoming",level:2},{value:"Example",id:"example",level:2}],c={toc:p},m="wrapper";function u(e){let{components:t,...n}=e;return(0,o.kt)(m,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"devshell-scripts-mission-control"},"Devshell scripts (",(0,o.kt)("inlineCode",{parentName:"h1"},"mission-control"),")"),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Platonic-Systems/mission-control"},"mission-control")," flake-parts module enables creating a set of scripts or commands to run in the Nix dev shell. This makes it possible for the project's user to locate all of the commands\xa0they need (to get started) in one place, often replacing the likes of ",(0,o.kt)("inlineCode",{parentName:"p"},"Makefile")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"bin/")," scripts."),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("p",null,"To use this module, add ",(0,o.kt)("inlineCode",{parentName:"p"},"mission-control")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"inputs"),","),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nix"},'{\n  # Inside inputs\n  mission-control.url = "github:Platonic-Systems/mission-control";\n}\n')),(0,o.kt)("p",null,"and import its flakeModule:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nix"},"{\n  # Inside mkFlake\n  imports = [\n    inputs.mission-control.flakeModule\n  ];\n}\n")),(0,o.kt)("h2",{id:"add-a-script-haskell"},"Add a script (Haskell)"),(0,o.kt)("p",null,"Here we'll show a sample of scripts that are particular useful when developing ",(0,o.kt)("inlineCode",{parentName:"p"},"[Haskell](/haskell-flake)")," projects."),(0,o.kt)("h3",{id:"docs-hoogle"},"Docs (Hoogle)"),(0,o.kt)("p",null,"We can add a convenient script to start Hoogle on project dependencies as follows. As a result, typing ",(0,o.kt)("inlineCode",{parentName:"p"},", docs")," in the dev shell will start Hoogle."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nix"},"{\n  # Inside perSystem\n  mission-control.scripts = {\n    docs = {\n      description = \"Start Hoogle server for project dependencies\";\n      exec = ''\n        echo http://127.0.0.1:8888\n        hoogle serve -p 8888 --local\n      '';\n      category = \"Dev Tools\";\n    };\n  };\n}\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"exec")," option can be either a shell script (string) or a Nix package. The ",(0,o.kt)("inlineCode",{parentName:"p"},"category")," option defines the group that this script belongs to, when displayed in the menu."),(0,o.kt)("h3",{id:"cabal-repl"},"Cabal repl"),(0,o.kt)("p",null,"To start a cabal repl from your devShell on running  ",(0,o.kt)("inlineCode",{parentName:"p"},", repl"),", use:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nix"},'{\n  # Inside perSystem\n  mission-control.scripts = {\n    repl = {\n      description = "Start the cabal repl";\n      exec = \'\'\n        cabal repl "$@"\n      \'\';\n      category = "Dev Tools";\n    };\n  };\n}\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.gnu.org/software/bash/manual/html_node/Special-Parameters.html"},(0,o.kt)("inlineCode",{parentName:"a"},'"$@"'))," represents the command-line arguments passed to ",(0,o.kt)("inlineCode",{parentName:"p"},", repl"),". This allows us to pass custom arguments to ",(0,o.kt)("inlineCode",{parentName:"p"},"cabal repl"),". For example, if you wish to run an executable ",(0,o.kt)("inlineCode",{parentName:"p"},"foo")," from your project in cabal repl, you'd run ",(0,o.kt)("inlineCode",{parentName:"p"},", repl exe:foo"),". Similarly, to get into the repl for a library ",(0,o.kt)("inlineCode",{parentName:"p"},"bar")," you'd run ",(0,o.kt)("inlineCode",{parentName:"p"},", run lib:bar"),"."),(0,o.kt)("h3",{id:"treefmt"},"treefmt"),(0,o.kt)("p",null,"If you use the ",(0,o.kt)("a",{parentName:"p",href:"/treefmt-nix"},"treefmt")," module for autoformatting the source tree, you can alias it as ",(0,o.kt)("inlineCode",{parentName:"p"},", fmt"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nix"},'{ \n  # Inside perSystem\n  mission-control.scripts = {\n    fmt = {\n      description = "Format the source tree";\n      exec = config.treefmt.build.wrapper;\n      category = "Dev Tools";\n    };\n  };\n}\n')),(0,o.kt)("p",null,"Note that ",(0,o.kt)("inlineCode",{parentName:"p"},"exec")," in this example is a Nix package."),(0,o.kt)("h2",{id:"tips"},"Tips"),(0,o.kt)("h3",{id:"wrappername"},"wrapperName"),(0,o.kt)("p",null,"If you don't wish to run your command using ",(0,o.kt)("inlineCode",{parentName:"p"},", <command>")," you can change the ",(0,o.kt)("inlineCode",{parentName:"p"},",")," to be any string of your choice by setting the option ",(0,o.kt)("inlineCode",{parentName:"p"},"wrapperName"),", as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nix"},'{\n  # Inside perSystem\n  mission-control = {\n    wrapperName = "s";\n  };\n}\n')),(0,o.kt)("h2",{id:"upcoming"},"Upcoming"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/Platonic-Systems/mission-control/issues/4"},"Zsh and bash shell completion"))),(0,o.kt)("h2",{id:"example"},"Example"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/srid/haskell-template/blob/master/flake.nix"},"https://github.com/srid/haskell-template/blob/master/flake.nix"))))}u.isMDXComponent=!0}}]);